娜娜作者于2020年12月被捕，网站没有关闭，过了几天后台崩溃，刷课客户端功能失效，网站前端及用户下单系统一直在运行，今年7月，娜娜的其中一个网站（<a href="http://wk.nanashuake.com" target="_blank">wk.nanashuake.com</a>）备案被注销，另一网站（<a href="http://wk.nanayun.com/" target="_blank">wk.nanayun.com</a>）仍在运行，但我无法登录。

------------

![](https://z3.ax1x.com/2021/07/28/W7GM7D.png)

------------

不过在6月30日，网站失效之前，我就已经启动了克隆项目，并备份了娜娜全部前端文件与部分后端接口格式，详情见文章：<a href="http://blog.xiao8.icu/?post=8" target="_blank">娜娜交单网站前后端克隆站思路</a>，在项目进行到一半的时候，娜娜的备案被注销，无法再访问原网站进行对比尝试，只能凭借感觉继续适配没有记录的接口，好在娜娜的网站有一个统一的数据格式，克隆工作在7月28日顺利完成。

测试网址：<a href="http://wk.xiao8.icu/" target="_blank">wk.xiao8.icu</a>
测试账号：admin
测试密码：123456

------------

系统介绍：

1. 所有接口全适配，目前只支持“按科”计费。
2. 下级开户、充值等功能与原娜娜相同。
3. 下级改价扣费规则改为“按比例扣下级余额”，而不是原来的“上级补差价”。
4. 使用大量“舍尾法”、“进一法”计算并控制余额的小数位数为两位，防止刷余额。
5. 允许平开，如果不允许平开，也修复了类似“0.20001”单价的平开bug。
6. 所有课程都需要查课并勾选课程后再交单，不允许直接点击交单按钮交单。
7. 下单即扣费，而不是上号扣费。
8. 去掉“删除订单”、“详情”按钮，订单页直接按课程显示，而不是显示账号列表。
9. 不会合并相同订单，重复下单会重复扣费。
10. 有下级但失去开户权限的账户，不允许再修改下级的开户权限。
11. 余额 >=1 的下级不允许删除。
12. token随密码变化，修改密码后会马上被踢下线，需要重新登陆，否则无法使用。
13. 和原娜娜一样，所有接口使用token验证，但被封禁后会马上被踢下线，所有接口禁止访问。
14. 不使用原娜娜的前后端分离跨域设计，后端使用php+mysql实现，前后端文件位于同一服务器内。

------------

![](https://z3.ax1x.com/2021/07/28/W7B2RO.png)

------------

![](https://z3.ax1x.com/2021/07/28/W7BfQe.png)

------------
