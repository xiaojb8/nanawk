娜娜作者于2020年12月被捕，网站没有关闭，过了几天后台崩溃，刷课客户端功能失效，网站前端及用户下单系统一直在运行，今年7月，娜娜的其中一个网站（<a href="http://wk.nanashuake.com" target="_blank">wk.nanashuake.com</a>）备案被注销，另一网站（<a href="http://wk.nanayun.com/" target="_blank">wk.nanayun.com</a>）仍在运行，但我无法登录。

------------

![](https://z3.ax1x.com/2021/07/28/W7GM7D.png)

------------

不过在6月30日，网站失效之前，我就已经启动了克隆项目，并备份了娜娜全部前端文件与部分后端接口格式，详情见文章：<a href="http://blog.xiao8.icu/?post=8" target="_blank">娜娜交单网站前后端克隆站思路</a>，在项目进行到一半的时候，娜娜的备案被注销，无法再访问原网站进行对比尝试，只能凭借感觉继续适配没有记录的接口，好在娜娜的网站有一个统一的数据格式，克隆工作在7月28日顺利完成。

测试网址：<a href="http://wk.xiao8.icu/" target="_blank">wk.xiao8.icu</a>
测试账号：admin
测试密码：123456

------------

系统介绍：

1. 所有接口全适配，目前只支持“按科”计费。
2. 下级开户、充值等功能与原娜娜相同。
3. 下级改价扣费规则改为“按比例扣下级余额”，而不是原来的“上级补差价”。
4. 使用大量“舍尾法”、“进一法”计算并控制余额的小数位数为两位，防止刷余额。
5. 允许平开，如果不允许平开，也修复了类似“0.20001”单价的平开bug。
6. 所有课程都需要查课并勾选课程后再交单，不允许直接点击交单按钮交单。
7. 下单即扣费，而不是上号扣费。
8. 去掉“删除订单”、“详情”按钮，订单页直接按课程显示，而不是显示账号列表。
9. 不会合并相同订单，重复下单会重复扣费。
10. 有下级但失去开户权限的账户，不允许再修改下级的开户权限。
11. 余额 >=1 的下级不允许删除。
12. token随密码变化，修改密码后会马上被踢下线，需要重新登陆，否则无法使用。
13. 和原娜娜一样，所有接口使用token验证，但被封禁后会马上被踢下线，所有接口禁止访问。
14. 不使用原娜娜的前后端分离跨域设计，后端使用php+mysql实现，前后端文件位于同一服务器内。

------------

![](https://z3.ax1x.com/2021/07/28/W7B2RO.png)

------------

![](https://z3.ax1x.com/2021/07/28/W7BfQe.png)

------------
## GitHub地址：<a href="https://github.com/xiaojb8/nanawk" target="_blank">https://github.com/xiaojb8/nanawk</a>


## 安装方法：
1. 修改服务器伪静态规则，隐藏.php扩展名（不隐藏将无法使用）
2. 修改 static\js\app.13522539.js 第3052行，改为自己服务器网址。
3. 删除 index.html 239-224行，这行是登录页的“平台介绍”和“获取账号”按钮。
4. 修改 core\DB.php 里面填写你自己的数据库信息。
5. 修改 core\core.php 第43行，修改token盐值，第47行是密码加密算法。
6. 修改 core\config.php 修改平台名称和开户默认密码。
7. 修改 agentList\myAgent\createAgent.php 第48行，修改“<”为“<=”即可禁止平开。
8. 修改 agentList\myAgent\saveChargeV2.php 第19行最小充值金额，第26行扣费算法，+1为手续费。
9. 修改 account\changePwdV2.php 第7-9行，禁止admin修改密码，删除即可。
10. 修改 client\website\websiteNoticeInfo.php 修改网站公告（注意转义）。
11. 修改 userAdd.php 第55行到最后，查课算法，根据平台ID进行判断，然后导入api\ck\文件夹下的查课接口进行查课，为防止白嫖已经删除查课接口，请自行适配。
11. 将全部文件上传到服务器，将data.sql导入mysql数据库。
12. 顶级账号为xiao8 密码123456，请自行在数据库修改。
13. 数据库goods表为商品，id为商品id，与第11条匹配，show字段为1则可以下单，不为1则无法下单与查课，multiple字段为价格倍数，与用户单价相乘则为真实价格。

## 提示：
1. 不卖系统
2. 不提供技术咨询
3. 仅为交单系统，没有刷课功能，请自行开发对接
4. 不提供对接其他平台功能
5. 前端是经过编译的，我不是娜娜作者，不能解
6. 前端作者已经入狱，所以使用此系统有一定的法律风险，傻白甜请勿使用。
7. 网站或介绍如有问题，请在github上提交issues，不会添加新功能。
7. 对于那些“端起碗吃肉，放下筷子骂娘”的人，请保护好你的个人隐私，正义会来临，正义也会迟到。

## 欢迎光临我的博客http://blog.xiao8.icu/
